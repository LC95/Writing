# 爱尔兰政府委托的福利处理系统的开发

为了测试裸对象方法的可行性，并验证前一章中预测的好处，作者寻找合适用裸对象设计和实现业务系统的机会。1999年初, 第一次机会出现了, 在爱尔兰社会和家庭事务部(Irish Department of Social and Family Affairs, DSFA)。

## 案例研究背景

社会和家庭事务部（DSFA）是负责管理社会福利计划的爱尔兰政府部门。 1998年之前，它被称为社会福利部。 该部门在很大程度上依赖信息技术来完成其任务。 它有大约2000台个人电脑，但其核心交易处理程序（在线和批处理）都是基于大型机的，可通过大约4000个绿屏哑终端访问。 这些系统在技术上是过时的，维护起来越来越昂贵。 例如，每当政府更改福利率或规则时，它们都需要手动重新编程。 目前，每种主要类型的福利都有一个单独的系统 - 儿童福利，残疾，失业等。 虽然有一个中央记录系统（一个有效的客户数据库），但信息和功能的共享要少得多。 例如，许多系统都有自己独立的机制来生成付款。 文字处理，电子邮件和日历工具通过基于大型机的All-in-One套件提供，并且它们与事务系统之间没有集成。

多年来，对部门内组织敏捷性的需求不断增长，这转化为对信息系统内更高灵活性的需求。 互联网和智能卡等技术发展为DSFA及其客户带来了巨大的潜在利益，包括易于访问，丰富的信息和成本节约。 政府一直在努力提高灵活性，包括引入新形式福利的能力以及改善对客户的服务。 爱尔兰有各种电子政务举措，其中最重要的是REACH计划，该计划将提供一个共同的“电子经纪人”，用于获取有关多个政府机构提供的服务的信息，这是一种识别和认证的核心手段， 以及个人数据保险库，使客户能够更好地控制自己的隐私。

为了满足这些不同需求，DSFA于1999年构思了一种新的服务交付模型（SDM），强调电子商务，敏捷性和客户响应能力。 SDM强调了对核心系统的全新体系结构的需求，这种体系结构不仅能够支持SDM的特定需求，而且还能更好地适应未来未预见的业务变化。

## 早期实验

早在1999年，IS管理层开始意识到作者从行为完整的对象构建业务系统的研究，以及新出现的裸体对象概念。 虽然管理层并不一定接受该阶段裸体对象的所有理论论据，但假设的好处与该部门提出的新架构的目标很好地吻合。 IS管理也被裸体对象的视觉具体性所吸引（即核心业务对象也是用户构造的事实），并且认为这将使非IT经理更容易参与关键设计决策。

早在1999年，在作者的帮助下，信息系统部门就IT和业务部门的一些高级管理人员开展了一关于面向对象思维的教育研讨会。鉴于此时没有支持裸体对象的框架，并且没有已知的事务业务系统示例以这种方式构建，在整个研讨会中使用了一个名为The Incredible Machine的消费者软件作为比喻。（这是使用单个比喻来指导业务系统的高级设计的一个很好的例子, 正如极限编程学科所倡导的那样）。在The Incredible Machine中（见图4-1），用户面临系列物理挑战，必须构建一个复杂的，看起来不太可能的机器模拟（以艺术家Heath RobinsonRube Goldberg的风格）解决它们。除了展示问题解决系统的概念之外，从用户的角度看，The Incredible Machine也非常清晰地面向对象：用户从零件目录拖入工作空间的元素不仅仅是可视化表示，而且还带来了该部件的完整模拟物理行为。

其中一个研讨会(为期一天，有六名经理参加)试图确定DSFA业务建模可能的核心业务对象。参与者被邀请直接建议对象类别:没有尝试预先指定用例。到上午结束时，已经产生了大约20个候选对象类的列表。下午，通过寻找重复或同义词，通过认识到某些候选对象是其他对象的自然子类，以及通过消除候选对象(经过进一步讨论，这些候选对象最终不是核心业务对象，因为它们可以更好地表示为简单属性或其他对象的方法)，来减少这个列表。结果是列出了七个核心类别:客户、案例、计划(意思是福利计划)、支付、服务(非货币福利，如公共汽车通行证)、社区和官员。(在这最初的七个中，除了一个，其余都以第一天定义的大致形式幸存下来。由于随后对该部的职责进行了较小的重新定义，社区被撤销。它曾一度是社会、社区和家庭事务部。)

接下来，研究小组被要求想象用户将如何与每个对象交互，方法是提出以下问题:

  1. 这个对象在屏幕上会是什么样子
  2. 用户可能想把它拖到哪里
  3. 通过右键单击此对象，用户希望能够调用哪些操作

结果是一个“知道什么”和“知道如何做”的职责列表，强调后者，以避免将对象仅仅看作复杂的数据集。结果是对一组行为丰富的对象进行了非常粗略的定义。

这些目标责任定义草案被翻译成一个粗略的系统视觉模型，供就索赔作出决定的官员(该部有数百名此类官员)使用。这个模型实际上是一系列作为幻灯片的手绘截屏(见图4-2)，但是一个精心排练的演示创建了一个工作系统的真实模拟，图标在屏幕上被拖动，菜单弹出响应鼠标右键。这个模拟演示了一小组特定的用例。然而，重要的是要理解，这些用例只是用来说明一个由一小组行为上完整的对象构建的系统的潜在功能。用例没有被用来分析需求或者识别对象；事实上，它们是在对象和它们的高级职责被指定之后才被写的。(这一主题在第五章中再次出现)。

图4-2使用裸对象设计的系统的用户界面的原始PowerPoint模型该模型向一组没有参与建模研讨会的高级经理演示。一些答复总结了其影响:

  1. "我可以看到整个组织中的每个人，直到部长本人，都可以使用相同的系统"。 这并不意味着所有用户都会执行相同的操作，或者确实具有相同级别的授权; 相反，组织所做的一切都可以表示为对少数关键对象的操作。 这种一致的界面有助于打破内部分歧之间的一些障碍，并使个人更容易进入不同的责任领域。
  2. "此接口对于高容量数据输入任务可能不是最佳的"。 关于此问题存在争议，直到有人指出DSFA致力于增加电子访问（通过网络，智能卡和电话），以及对系统本身采用更加集成的方法，这意味着大部分例行数据输入工作将会无论如何都消失了。
  3. "这个系统强化了我们一直向员工传递的关于改变工作方式的信息"。DSFA致力于从传统的装配线式索赔处理方法(每个人在这一过程中只需执行一小步)转向另一种模式，在这种模式下，更多的官员可以处理完整的索赔，经过适当培训的官员将来可能会为一个客户处理所有利益。演示中的经理们认为，即使是这个简单的模型也能帮助向用户传达这样的信息，即他们是问题解决者，而不是过程追随者。这与一些供应商提出的方法形成了鲜明对比，后者强调使用基于规则的技术或“智能软件代理”来尽可能自动化决策。相反，基于对象的模型建议了一个高度利用用户自然问题技能的环境。从这个意义上说，该系统的设计可以被视为有助于促进根本的文化变革。换句话说，尽管探索裸对象方法的最初动机是它提高系统灵活性的潜力，但是在第一次模型演示之后，经理们也开始对裸对象将带来的更强大的用户界面风格所带来的潜在好处感兴趣。

除了用户代表的积极反应之外，与以前在部门范围内进行的建模（无论是对象，数据还是流程）相比，IS管理层对此练习的效率也印象深刻。 虽然DSFA决不准备在该阶段使用裸对象进行全面实施，但所有人都同意应该更深入地探讨这一概念。

## 将这一概念应用于儿童福利管理

2000年初，业务案例采取行动变得更加紧迫。现有的儿童福利管理系统急需更换。政府已经表示，今后可能对儿童福利进行修改，但现有系统根本无法解决(具体而言，福利的可能性取决于儿童岁数)。儿童福利是DSFA管理的较为简单的计划之一，规模相对较小:现有系统约有80名用户。然而，处理索赔所涉及的活动与其他计划有很多相似之处。这似乎是一个测试新方法部署的理想机会。

在一系列涉及高级管理人员和用户代表的研讨会上，最初的对象模型（来自为期一天的研讨会）中概述的职责现已从儿童福利管理的特定角度得到充实。 完善了对象责任，确定了新的职责。 还添加了新的子类和辅助（或“聚合”）对象。 并且整个模型已经针对许多运营业务场景进行了粗略测试。 此外，该模型还经过测试（在纸面上），针对各种DSFA业务未来可能发生变化的情景。 业务对象模型以文本描述的形式体现，并在附录II中复制。

在这些研讨会期间，DSFA利用了由Robert Matthews开发的基于Java的框架的早期原型，该框架最终成为Naked Object。虽然这不是DSFA最终用于实现的技术，但使用该框架帮助建立参与者对裸对象概念的理解。 以可用系统的形式（而不仅仅是图表）描述对象模型的能力是说服管理者参与建模过程的重要因素

## 技术验证

与此同时，DSFA中的另一组IT经理致力于定义`Naked Object Architecture`的原则，这些原则将完全支持裸对象的概念，同时满足DSFA在核心业务系统体系结构中的其他特定需求。这些原则在附录I中进行了复制，但是下面的例外说明了对裸对象的承诺

**暴露(Exposure)**。裸对象直接暴露给用户---以一种让用户清楚他们在处理一个物体的形式。这包括使用图标来表示对象。然而，最重要的是，它包括将对象的潜在行为暴露给用户，用户通常选择一个对象，然后在其上调用一个行为。这实现了用户交互的“名词-动词”风格，而不是更常见的动词-名词风格。通过这种方式，`Naked Object Architecture`为用户提供了一套操作工具，并**允许设计不规定用户操作顺序**的业务系统。这允许用户成为问题解决者，而不仅仅是过程追随者。

**类方法(Class Method)**. 除了暴露对象实例，`Naked Object Architecture`还为用户提供了裸对象类的显式表示。使用这些类表示，用户可以启动一组类方法，包括例如用于创建该类的新实例、用于使用唯一标识符从存储中检索该类的特定实例以及用于查找匹配指定标准的实例的方法

**单点定义(Single point of definition)**. 理想情况下，裸对象是在一个地方定义的。裸对象在体系结构的多层中的表示形式和角色都来自于该单一定义——包括数据库中持久性存储的定义。

**自动生成的用户界面(Auto-generated user interface)**. 理想情况下，默认用户界面也是裸对象的中心定义自动创建的。 业务对象为其每个方法定义表示层需要显示和从用户捕获的业务相关信息。 这些信息要经过安全过滤，以确保每个用户只显示他/她有权查看的信息。

作为一个公共部门机构，所有采购都要遵守欧盟的招标规则。因此，DSFA为技术演示人员发布了RFT(招标请求)，它将实现裸对象体系结构的原则，包括可伸缩企业体系结构所需的所有服务(例如，消息代理、事务监视和使用关系数据库的持久性)。该部门从三个不同的供应商那里委托了三个这样的供应商，每个供应商都使用不同的对象技术

  1. Sun’s Enterprise Java Beans (EJB)
  2. Microsoft’s COM+
  3. A proprietary object-oriented package.

## 阶段I 实现

在评估了演示之后，DSFA提出了一个新的RFT，用于开发和实施一个全面的裸对象体系结构，加上一组指定的领域对象类，这些对象类需要提供一个全新的应用程序来取代现有的儿童福利管理系统。招标书没有提供完整的功能规范，但它提供了核心业务对象所需的高级职责的描述(附录二)。该合同于2001年2月授予DMR咨询公司(后更名为富士通咨询公司)，其初衷是新系统将于2002年3月投入使用。(在整个43个实施过程中，提交人继续临时担任DSFA的顾问，但与承包商没有直接联系)。该项目受到延误——一些是由于工作过度，一些是由于技术困难，还有一些是由于工业行动。然而，该系统最终在2002年11月投入使用，到该月底完全取代了旧系统。

所有业务逻辑都包含在实体对象类中(在此图中标记为“业务对象”)。每个业务对象都有一个对应的数据库访问对象，它管理对象属性到持久存储机制的映射。职责划分的部分原因是一些业务对象与其他系统共享它们的持久表示，特别是通过中央记录系统。一种叫做Attunity Connect的产品管理与所有现有数据库的数据交换。业务对象和数据访问对象是用Visual Basic 6.0编写的

业务对象与通用查看机制之间的通信采用XML消息的形式，该机制通过多层中间件。因此，领域层中的业务对象将发送XML消息，该消息指示查看机制在屏幕上呈现对象，默认为图标。 XML消息还指定如果用户选择打开该对象的视图，则可以查看或编辑哪些属性; 与其他对象的关联（将在其自身右侧显示为图标），以及如果用户右键单击该对象，将在弹出菜单中提供的方法列表。 类似的机制使用类方法的弹出菜单生成类图标。 图4-5显示了应用程序的屏幕截图